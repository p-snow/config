#+TITLE: dotfiles
#+PROPERTY: header-args       :tangle-mode (identity #o644)
#+PROPERTY: header-args+      :mkdirp yes
#+PROPERTY: tangle-target-dir .files

#+STARTUP: hideblocks

* User Information
- my home directory
  #+name: home-dir
  #+begin_src bash
    echo "${HOME}"
  #+end_src
- my user name on system
  #+name: whoami
  #+begin_src bash
    whoami
  #+end_src
- my email address
  #+name: email
  #+begin_src bash
    echo -n "${EMAIL}"
  #+end_src
* Bash
- bash profile
  #+BEGIN_SRC bash :tangle (expand-tangle-target ".bash_profile")
    #!/usr/bin/env bash

    if [ -f ~/.bashrc ]; then
       source ~/.bashrc
    fi
  #+END_SRC
- bashrc
  #+BEGIN_SRC bash :tangle (expand-tangle-target ".bashrc")
    #!/usr/bin/env bash

    # All login settings is in ~/.bashrc because
    # shell on Emacs does not read ~/.bash_profile

    export EDITOR=~/usr/bin/emacsclient
    export GIT_EDITOR=~/usr/bin/emacsclient
    export VIEWER=less

    USER_PATHS=(
      "${HOME}/bin"
      "${HOME}/usr/bin"
      "${HOME}/usr/bin/calibre"
      "${HOME}/usr/sbin"
      "${HOME}/Applications"
      "${HOME}/go/bin"
      "${HOME}/.cask/bin"
      "${HOME}/.local/bin"
      "${HOME}/.cabal"
    )
    for path in "${USER_PATHS[@]}"; do
      if [ -d "${path}" ]; then
        export PATH="${path}:$PATH"
      fi
    done

    export MANPATH="${HOME}/usr/share/man:${MANPATH}"
    export INFOPATH="${HOME}/usr/share/info:${INFOPATH}"
    export PKG_CONFIG_PATH="${HOME}/usr/lib/pkgconfig:${HOME}/usr/lib64/pkgconfig:${HOME}/usr/lib/x86_64-linux-gnu/pkgconfig:$PKG_CONFIG_PATH"

    if [ -d "${HOME}/.anyenv" ]; then
      export ANYENV_ROOT="${HOME}/.anyenv"
      export PATH="${HOME}/.anyenv/bin:$PATH"
    fi
    if [ -v "ANYENV_ROOT" ] && type anyenv >/dev/null 2>&1 ; then
      eval "$(anyenv init -)"
    fi
    export GOPATH=${HOME}/go

    export LD_LIBRARY_PATH="${HOME}/usr/lib:${HOME}/usr/lib64:${HOME}/usr/lib/x86_64-linux-gnu:/usr/lib:/usr/local/lib:/usr/lib/x86_64-linux-gnu/"

    python2_sp=${HOME}/usr/lib/python2.7/site-packages/
    if [ -d ${python2_sp} ]; then
      export PYTHONPATH=${python2_sp}
    fi

    for bash_src in "${HOME}"/bin/bash_*.sh; do
      . "${bash_src}"
    done

    unset -v EMACS # for ansi-term in emacs
    EDITOR="emacs"

    case ${TERM} in
    linux) export LANG="C";;
    ,*)     export LANG="ja_JP.UTF-8";;
    esac
    export LC_MESSAGES="C"

    # prompt
    MACHINE=$(echo $(uname -n) | awk -F . '{print $1}')
    PS1="[\u@${MACHINE}:\\W]\n\$ "

    # function/variable used in libvterm/emacs

    vterm_prompt_end(){
      vterm_printf "51;A$(whoami)@$(hostname):$(pwd)"
    }
    PS1=$PS1'\[$(vterm_prompt_end)\]'

    vterm_printf(){
      if [ -n "$TMUX" ]; then
        # Tell tmux to pass the escape sequences through
        # (Source: http://permalink.gmane.org/gmane.comp.terminal-emulators.tmux.user/1324)
        printf "\ePtmux;\e\e]%s\007\e\\" "$1"
      elif [ "${TERM%%-*}" = "screen" ]; then
        # GNU screen (screen, screen-256color, screen-256color-bce)
        printf "\eP\e]%s\007\e\\" "$1"
      else
        printf "\e]%s\e\\" "$1"
      fi
    }

    PROMPT_COMMAND='echo -ne "\033]0;${HOSTNAME}:${PWD}\007"'


    export GTAGSCONF=${HOME}/usr/share/gtags/gtags.conf
    export GTAGSLABEL=pygments

    export WINEARCH=win64
    export WINEPREFIX=~/.wine
  #+END_SRC
- profile
  #+BEGIN_SRC bash :tangle (expand-tangle-target ".profile")
    # ~/.profile: executed by the command interpreter for login shells.
    # This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login
    # exists.
    # see /usr/share/doc/bash/examples/startup-files for examples.
    # the files are located in the bash-doc package.

    # the default umask is set in /etc/profile; for setting the umask
    # for ssh logins, install and configure the libpam-umask package.
    #umask 022

    # if running bash
    if [ -n "$BASH_VERSION" ]; then
        # include .bashrc if it exists
        if [ -f "$HOME/.bashrc" ]; then
            . "$HOME/.bashrc"
        fi
    fi

    # set PATH so it includes user's private bin if it exists
    if [ -d "$HOME/bin" ] ; then
        PATH="$HOME/bin:$PATH"
    fi

    # set PATH so it includes user's private bin if it exists
    if [ -d "$HOME/.local/bin" ] ; then
        PATH="$HOME/.local/bin:$PATH"
    fi
  #+END_SRC
** secret parts                                   :crypt:
-----BEGIN PGP MESSAGE-----

hQEMA9uWvE5LJ2ejAQgArGORah6PhZQyWd8kqSGEwIXRkASbFg7cRhVeqngN02Ji
myXYGFNOGf6yhRQb9BWUvOD9+GfGYn8Jp/LlKVRQxIwhZDj1gb6SGcEJeg1qWAQY
AT4aowLdxyDt+rw3p+ezuZU5V2xXV4QHhT721A0+E4EU40FuY0DoHlE7RurSotXw
fyJn2nu70XOyALvM+rsEE+T3HimvZZ1czubN721QBafmA6BaAbbG0xAKqX00DZ4I
EpDA8xAkEupTh5QXIoq45PKifs09gxd2zuzBhUH2XGR75XoriAr/ZJx6INqyuBbQ
Um6lhw6YclvDhkk7tFY4DKw7jHwxEBoNsefJMy/tENKkAQRsZkDUk4hYw0a0VaMf
W8QEyJYqZKZHnhIvOJeawzvF04ryI/ok6LVlySWwwsK8TxNlXImNDr3jqdTTEJVD
esnevCcl5Gon8qiUjFXwX6bomE+T9/jUK88HWJ9G5v2PUS/2QDmbU0o1MU+tUYp+
i4IvaH/QeyE4KQkwJ25yAl6/juJZfXsA9uiWlH9hWhYBMyG+zYxx/kepJqtStCV0
Q7sbt0I=
=sBHC
-----END PGP MESSAGE-----
* abcde
#+BEGIN_SRC conf :tangle (expand-tangle-target ".abcde.conf")
  FDKAACENCOPTS='--bitrate 256k'

  OUTPUTFORMAT='${ARTISTFILE}/${ALBUMFILE}/${TRACKNUM}.${TRACKFILE}'
#+END_SRC
* Git
- git ignore
  #+BEGIN_SRC conf :tangle (expand-tangle-target ".config/git/info/ignore")
    #
    # ~/.gitignote
    #
    ## archive ##
    ,*.zip
    ,*.lzh
    ,*.tar.gz
    ,*.tgz
    ,*.bz2
    ,*.dmg

    ## Compiled object files ##
    ,*.slo
    ,*.lo
    ,*.o
    ,*.obj

    ## Compiled Dynamic libraries ##
    ,*.so
    ,*.dylib
    ,*.dll

    ## Compiled Static libraries ##
    ,*.lai
    ,*.la
    ,*.a
    ,*.lib

    ## Executables ##
    ,*.exe
    ,*.out
    ,*.app

    ## Windows ##
    Thumbs.db
    ehthumbs.db
    Desktop.ini
    $RECYCLE.BIN/
    ,*.cab
    ,*.msi
    ,*.msm
    ,*.msp

    ## Mac ##
    .DS_Store
    .AppleDouble
    .LSOverride
    .Spotlight-V100
    .Trashes
    ._*

    ## Linux ##
    locate.db

    ## version control system ##
    .git/
    .hg/
    .svn/

    ## backup,log ##
    ,*~
    ~*
    ,*.swp
    .swp.*
    ,*.tmp
    ,*.bak
    ,*.old
    ,*.log
    .cache/
    ,*.autosave

    ## Emacs ##
    ,*.elc

    ## Vim ##
    ,*.un~
    Session.vim
    .netrwhist

    ## GNU GLOBAL ##
    GPATH
    GRTAGS
    GTAGS

    ## netbeans ##
    nbproject/
    ## intellij idea ##
    .idea/
    ## eclipse ##
    .settings/
    .project
    .classpath
    .buildpath
    ## XCode ##
    ,*.xcodeproj/*

    ## Build dir ##
    build/
  #+END_SRC
- git attributes
  #+BEGIN_SRC gitattributes :tangle (expand-tangle-target ".config/git/info/attributes")
    ,*.c diff=cpp
    ,*.h diff=cpp
    ,*.cpp diff=cpp
    ,*.hpp diff=cpp
    ,*.cs diff=csharp
    ,*.m diff=objc
    ,*.java diff=java
    ,*.html diff=html
    ,*.xml diff=html
    ,*.pl diff=perl
    ,*.pm diff=perl
    ,*.t diff=perl
    ,*.php diff=php
    ,*.ptml diff=php
    ,*.py diff=python
    ,*.rb diff=ruby
    ,*.js diff=java
    ,*.csv encoding=cp932
    ,*.json diff=json
    ,*.gpg filter=gpg diff=gpg
  #+END_SRC
- git config
  #+BEGIN_SRC gitconfig :noweb tangle :tangle (expand-tangle-target ".config/git/config")
    [core]
            excludesfile = <<home-dir()>>/.config/git/info/ignore
            attributesfile = <<home-dir()>>/.config/git/info/attributes
            editor = emacs
            symlinks = true
            # Unicode
            precomposeunicode = true
            quotepath = true
            autocrlf = false
    [push]
            # simple,matching,upstream,current
            default = simple
    [color]
            ui = auto
            status = auto
            diff = auto
            branch = auto
            interactive = auto
            grep = auto
    [diff]
            patience = true
    [diff "gpg"]
            textconv = gpg --no-tty --decrypt
    [help]
            autocorrect = 0
    [alias]
            co = checkout
            ca = commit -a -v
            ce = commit -v --amend
            st = status --branch --short
            si = status --ignored --short
            branches = branch -a
            remotes = remote -v
            tags = tag -l
            lg = log --graph --all --decorate --abbrev-commit --branches --date=short --pretty=format:\"%C(red)%h%C(reset) %C(green)[%ad]%C(reset) %s %C(cyan)@%an%C(reset) %C(yellow)%d%C(reset)\"
            fp = fetch --prune
            di = diff
            dh = diff --histogram
            dw = diff --word-diff
            dc = diff --cached
            wc = whatchanged
    [user]
            email = 6841207+p-snow@users.noreply.github.com
            name = Kona-Yuki-SAN
    [credential]
            helper = /usr/bin/pass-git-helper -m <<home-dir()>>/.config/pass-git-helper/git-pass-mapping.ini
  #+END_SRC
- pre-commit
  pre-commit script is useful for checking strings to commit
  # #+begin_src bash :noweb tangle :tangle ./.git/hooks/pre-commit :tangle-mode (identity #o775)
    #!/usr/bin/env bash

    forbiddens=(
      <<home-dir()>>
    )

    . "$(git --exec-path)/git-sh-setup" # for die
    for forbidden in ${forbiddens[@]}
    do
      if git diff-index -p -M --cached HEAD -- \
          | grep '^+' \
          | grep "${forbidden}"; then
        die Blocking commit because string "${forbidden}" detected in patch
      fi
    done
  #+end_src

* GCompris
- Download executable
  execute following source block to download package file and execute it to install GCompris executable file
  #+begin_src sh :results output silent
    ver=1.1
    sh_file=gcompris-qt-${ver}-Linux64.sh
    if [ ! -x ~/Applications/gcompris-qt-${ver}-Linux/bin/gcompris-qt.sh ]; then
      cd ~/Applications && \
        curl -LJs --remote-name "https://gcompris.net/download/qt/linux/${sh_file}"
    fi
  #+end_src
- Desktop file
  #+BEGIN_SRC conf-desktop :noweb tangle :tangle (expand-tangle-target ".local/share/applications/gcompris.desktop")
    #!/usr/bin/env xdg-open
    [Desktop Entry]
    Type=Application
    Version=1.1
    Name=GCompris
    Comment=GCompris education app suite
    Exec=<<home-dir()>>/Applications/gcompris-qt-1.1-Linux/bin/gcompris-qt.sh %F
    Terminal=false
    Categories=Education;
  #+END_SRC
** Config file
#+begin_src conf :noweb tangle :comments noweb :tangle (expand-tangle-target ".config/gcompris/gcompris-qt.conf")
  [Admin]
  cachePath=<<home-dir()>>/.cache/KDE/gcompris-qt
  downloadServerUrl=https://cdn.kde.org/gcompris
  renderer=auto
  userDataPath=<<home-dir()>>/.local/share/GCompris

  [Favorite]
  baby_tangram\BabyTangram.qml=true
  babyshapes\Babyshapes.qml=false
  braille_fun\BrailleFun.qml=false
  canal_lock\CanalLock.qml=true
  color_mix_light\ColorMixLight.qml=true
  colors\Colors.qml=true
  hanoi_real\HanoiReal.qml=true
  maze\Maze.qml=true
  play_piano\PlayPiano.qml=true
  railroad\Railroad.qml=true
  traffic\Traffic.qml=true

  [%General]
  audioEffectsVolume=0.7
  backgroundMusicVolume=0.2
  baseFontSize=0
  defaultCursor=false
  demo=false
  enableAudioEffects=true
  enableAudioVoices=true
  enableAutomaticDownloads=true
  enableBackgroundMusic=true
  filterLevelMax=6
  filterLevelMin=1
  filteredBackgroundMusic=forest.ogg
  font=Andika-R.otf
  fontCapitalization=0
  fontLetterSpacing=0
  fullscreen=false
  isCurrentFontEmbedded=true
  key=
  kiosk=false
  locale=system
  noCursor=false
  previousHeight=1375
  previousWidth=2560
  sectionVisible=true
  showLockedActivities=false
  useWordset=true
  virtualKeyboard=false
  wordset=data2/words/words.rcc

  [Internal]
  exeCount=139
  lastGCVersionRan=10100

  [Levels]
  algebra_by\AlgebraBy.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  algebra_div\AlgebraDiv.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  algebra_minus\AlgebraMinus.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  algebra_plus\AlgebraPlus.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  categorization\Categorization.qml=1, 2, 3
  chronos\Chronos.qml=1, 2
  clockgame\Clockgame.qml=1, 2, 3, 4, 5, 6
  crane\Crane.qml=1, 2, 3, 4
  details\Details.qml=1, 2, 3
  enumerate\Enumerate.qml=1, 2, 3, 4
  geo-country\GeoCountry.qml=1, 2, 3, 4
  gnumch-equality\GnumchEquality.qml=1, 2, 3, 4
  gnumch-inequality\GnumchInequality.qml=1, 2, 3, 4
  guesscount\Guesscount.qml=1, 2, 3, 4
  guessnumber\Guessnumber.qml=1, 2, 3, 4, 5
  land_safe\LandSafe.qml=1, 2
  learn_additions\Learn_additions.qml=1, 2, 3
  learn_digits\Learn_digits.qml=1, 2, 3, 4, 5, 6, 7, 8, 9
  learn_subtractions\Learn_subtractions.qml=1, 2, 3
  lightsoff\Lightsoff.qml=1, 2, 3, 4, 5, 6, 7, 8, 9
  magic-hat-minus\MagicHat.qml=1, 2, 3, 4, 5, 6
  magic-hat-plus\MagicHatPlus.qml=1, 2, 3, 4, 5, 6
  memory-enumerate\MemoryEnumerate.qml=1, 2, 3, 4, 5, 6, 7, 8
  memory-math-add-minus-mult-div-tux\MemoryMathAddMinusMultDivTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-add-minus-mult-div\MemoryMathAddMinusMultDiv.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-add-minus-tux\MemoryMathAddMinusTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-add-minus\MemoryMathAddMinus.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-add-tux\MemoryMathAddTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-add\MemoryMathAdd.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-div-tux\MemoryMathDivTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-div\MemoryMathDiv.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-minus-tux\MemoryMathMinusTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-minus\MemoryMathMinus.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-mult-div-tux\MemoryMathMultDivTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9
  memory-math-mult-div\MemoryMathMultDiv.qml=1, 2, 3, 4, 5, 6, 7, 8, 9
  memory-math-mult-tux\MemoryMathMultTux.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  memory-math-mult\MemoryMathMult.qml=1, 2, 3, 4, 5, 6, 7, 8, 9, 10
  money\Money.qml=1, 2, 3
  money_back\MoneyBack.qml=1, 2, 3
  money_back_cents\MoneyBackCents.qml=1, 2, 3
  money_cents\MoneyCents.qml=1, 2, 3
  mosaic\Mosaic.qml=1, 2, 3, 4
  redraw\Redraw.qml=1, 2, 3
  redraw_symmetrical\RedrawSymmetrical.qml=1, 2, 3
  reversecount\Reversecount.qml=1, 2
  scalesboard\ScaleNumber.qml=1, 2, 3, 4, 5
  scalesboard_weight\ScalesboardWeight.qml=1, 2, 3, 4, 5, 6
  scalesboard_weight_avoirdupois\ScalesboardWeight.qml=1, 2, 3, 4, 5, 6
  share\Share.qml=1, 2, 3
  smallnumbers\Smallnumbers.qml=1, 2, 3, 4, 5, 6, 7, 8
  smallnumbers2\Smallnumbers2.qml=1, 2, 3, 4, 5, 6, 7, 8
  sudoku\Sudoku.qml=1, 2, 3, 4
  target\Target.qml=1, 2, 3, 4, 5

  [balancebox]
  filePath=qrc:/gcompris/src/activities/balancebox/resource/levels-default.json
  levels=builtin
  progress=12
#+end_src
* Email credentials                               :crypt:
-----BEGIN PGP MESSAGE-----

hQEMA9uWvE5LJ2ejAQf9HIbm4fXnkiUElAHbu8B/NYmkC58unK7BrZ/hjazdEFx5
gEFWNVE0SbjoEPA2GDbUimGmNW55E2Kq7KK7xTvspzC+cxxvCX7A4KuYO/Mf1Ku6
x1k2rcrXn/D/FNjKLut+cwMswA8mQPss/JOPzZGOhSsHpjYIt1UhfVmYgV+meYEQ
mn/jg5VsFkhlR2EKtkxie9G3k1KYK1/JSZBTY/VV/WLcxIkqMyaiGZl44QqXru9n
yhowUHof0egVWgMExFEqqnrY/vm/d8RotPq/VhRvgfsGfCtQD3Bkh2/av7sz3Sc1
j/e18WLqLMGGS7YdkaRUq2Aor44OGXkm9hs67/nep9LA0QH/aeJ0E4Wly2GG+TtR
x3sY1RiT0x84Y+ziIn2QxQK3HytaC7nGDUs6saQ2f9fDpx0+0JEqFCI47fQLvouJ
Xx9rw8O3PEITUV/f8skJVYOs0rC7hbdW7lcQLNH5eiunfFAStL1DO2bD+Bl8RCrW
p8Tqz2WuxCJMxu4acNMIGb3IRwngyeZZuqkCTLPJEGYlWRXQU6BQ8Tul/mvWLp1f
fEMvqTn0eyR56kI9rvMp56Pqtkj3olNi/YobbUAYe1C5NRxohTTpeM9cdP8wgV/q
Ed58AvRcpVZTH2s/5oyqwlKodyfIqT/PbSM5cnJLB0Y/gXcUIHIBJJDSjWj/sAAk
YcPdcBI55Rn+vW+rzbpSYFBejoNCO9GXgnhSs2y5ju9WeRcf9b0XyTFuRZ9RVNgc
MnOfxnEPg4z56D7BQdyPjttd+0unluNQwn/S6+hyrD7I/a8yqTjAj3Y8kBS+Srnc
vMfXovDLe5DIPERdKz48V5gR+kPqeRH215V0Sp1KQzD0ih+go+QEZppXh5LIQce9
fEVc
=KIEm
-----END PGP MESSAGE-----
* Login information                               :crypt:
-----BEGIN PGP MESSAGE-----

hQEMA9uWvE5LJ2ejAQf/bGK1WHe+jkoRoV0Zc/+JdxQKe3g6v5ZEgcbJEUvoX8kp
nDnyShR/pfajfakXzh3wD0otix5dr8xZVJJm5oiBFZaTuCeyZUoeeGVWxaXFqShQ
UQIQcATXKp8r41lp5mEHJrMorL4iWVLCBSftQ2jzdc0wsqs1ASIX6Q96OtD5D5+g
znX/1LAOMz3Lr3vo1M8Qxcx0ZaCtiW+gYz4pbCJdiOpIYvsc350lh67pjXYXZhq6
zot1DO278mStxH5Nj263uK6jA6D8KfeG5ea5aB6YiM6P9snE6WU1qkZQmsudSIB/
m0IKyj+1nJH3hHby6knyS5FUw4bOdve57jo67dg80dLApAErFvu+tcluKVs2yUeU
VQfqyLsU2pSNx/e7STQwSwoPNhET67UJRlI3dKCiHAHfBdYzXAjoQXqefpSlrjbf
g8zrIPUMK1MpeuWQ9HeIH6eaywFALnZExhtfXFaRDLtiNYnXMlwIdQ9CewA0Rl3m
RlTkh4uRPd7B44/s9GzMKd9DaDjTKNoRq/et14pKsDAc0K4pJdI97B9wyW506z/A
Ngxt3vhxeZWvZVnsAKWSAucyhaQ8BGWfKvPLjZid5mslhzJXHil5Xx+hn9STZ8Qi
sEdKK2Vphwatv4QdVz7dSEJyQ/e+it5tUSB/X6qoDMHY6OwhGM+6kQdLc4fvRfqW
gcckBL/R5A2WUvzaehfR6XKWe1rgESgDDGelR9CENzISbVVjo5r04/S/cGwug8Ss
fbmrvfnFu1NzGMqWER97y3R9Db7man5ce3G9x0GQkuPccIeuOQVehJsU3yHbEyye
AY4RXurg
=wgK4
-----END PGP MESSAGE-----
* pass
#+begin_src conf :tangle (expand-tangle-target ".config/pass-git-helper/git-pass-mapping.ini")
  [github.com*]
  username_extractor=specific_line
  line_username=2
  target=github.com
  # username_extractor=entry_name
#+end_src

* mpv
- mpv.conf
  #+begin_src conf :tangle (expand-tangle-target ".config/mpv/mpv.conf")
    ##################
    # video settings #
    ##################

    # Start in fullscreen mode by default.
    fs=yes


    ###########
    # General #
    ###########

    #save-position-on-quit
    no-border                               # no window title bar
    msg-module                              # prepend module name to log messages
    msg-color                               # color log messages on terminal
    term-osd-bar                            # display a progress bar on the terminal
    use-filedir-conf                        # look for additional config files in the directory of the opened file
    pause                                   # no autoplay
    force-window=immediate
    keep-open                               # keep the player open when a file's end is reached
    autofit-larger=100%x95%                 # resize window in case it's larger than W%xH% of the screen
    cursor-autohide-fs-only                 # don't autohide the cursor in window mode, only fullscreen
    # input-media-keys=no                     # enable/disable OSX media keys
    cursor-autohide=1000                    # autohide the curser after 1s

    screenshot-format=png
    screenshot-png-compression=8
    screenshot-template='~/Desktop/%F (%P) %n'

    hls-bitrate=max                         # use max quality for HLS streams


    #########
    # Cache #
    #########

    cache=yes
    cache-default=5000000                   # size in KB
    cache-backbuffer=25000                  # size in KB
    cache-initial=0                         # start playback when your cache is filled up with x kB
    cache-secs=10                           # how many seconds of audio/video to prefetch if the cache is active


    #############
    # OSD / OSC #
    #############

    osd-level=1                             # enable osd and display --osd-status-msg on interaction
    osd-duration=2500                       # hide the osd after x ms
    osd-status-msg='${time-pos} / ${duration}${?percent-pos: (${percent-pos}%)}${?frame-drop-count:${!frame-drop-count==0: Dropped: ${frame-drop-count}}}\n${?chapter:Chapter: ${chapter}}'
    # osd-status-msg='${=time-pos}'         # show raw position

    osd-font='Source Sans Pro'
    osd-font-size=64
    osd-color='#CCFFFFFF'                   # ARGB format
    osd-border-color='#DD322640'            # ARGB format
    #osd-shadow-offset=1                    # pixel width for osd text and progress bar
    osd-bar-align-y=0                       # progress bar y alignment (-1 top, 0 centered, 1 bottom)
    osd-border-size=2                       # size for osd text and progress bar
    osd-bar-h=2                             # height of osd bar as a fractional percentage of your screen height
    osd-bar-w=60                            # width of " " "


    #############
    # Subtitles #
    #############

    sub-use-margins
    sub-ass-force-margins

    demuxer-mkv-subtitle-preroll            # try to correctly show embedded subs when seeking
    sub-auto=fuzzy                          # external subs don't have to match the file name exactly to autoload
    embeddedfonts=yes                       # use embedded fonts for SSA/ASS subs
    sub-fix-timing=no                       # do not try to fix gaps (which might make it worse in some cases)
    sub-ass-force-style=Kerning=yes         # allows you to override style parameters of ASS scripts

    # the following options only apply to subtitles without own styling (i.e. not ASS but e.g. SRT)
    sub-font="Source Sans Pro Semibold"
    sub-font-size=36
    sub-color="#FFFFFFFF"
    sub-border-color="#FF262626"
    sub-border-size=3.2
    sub-shadow-offset=1
    sub-shadow-color="#33000000"
    sub-spacing=0.5


    #############
    # Languages #
    #############

    slang=enm,en,eng,de,deu,ger             # automatically select these subtitles (decreasing priority)
    alang=ja,jp,jpn,en,eng,de,deu,ger       # automatically select these audio tracks (decreasing priority)

    #########
    # Image #
    #########

    image-display-duration=4

    #########
    # Audio #
    #########

    audio-file-auto=fuzzy                   # external audio doesn't has to match the file name exactly to autoload
    audio-pitch-correction=yes              # automatically insert scaletempo when playing with higher speed
    volume-max=200                          # maximum volume in %, everything above 100 results in amplification
    volume=100                              # default volume, 100 = unchanged


    ################
    # Video Output #
    ################

    # Active VOs (and some other options) are set conditionally
    # See here for more information: https://github.com/wm4/mpv-scripts/blob/master/auto-profiles.lua
    # The script was modified to import functions from scripts/auto-profiles-functions.lua

    # Defaults for all profiles
    tscale=catmull_rom                      # sharp: oversample <-> linear (triangle) <-> catmull_rom <-> mitchell <-> gaussian <-> bicubic : smooth
    opengl-early-flush=no
    opengl-pbo=yes


    [high-quality]
    profile-desc=cond:is_desktop() and get('width', math.huge) < 3840
    scale=ewa_lanczossharp
    cscale=ewa_lanczossoft
    dscale=mitchell
    scale-antiring=0.7
    cscale-antiring=0.7
    dither-depth=auto
    correct-downscaling=yes
    sigmoid-upscaling=yes
    deband=yes
    hwdec=no

    [mid-quality]
    profile-desc=cond:(is_laptop() and not on_battery() and get('width', math.huge) < 1920) or (is_desktop() and get('width', math.huge) >= 3840)
    scale=spline36
    cscale=bilinear
    dscale=mitchell
    scale-antiring=1.0
    cscale-antiring=1.0
    dither-depth=auto
    correct-downscaling=yes
    sigmoid-upscaling=yes
    deband=yes
    hwdec=no

    [low-quality]
    profile-desc=cond:is_laptop() and (on_battery() or get('width', math.huge) >= 1920)
    scale=bilinear
    cscale=bilinear
    dscale=bilinear
    scale-antiring=0.0
    cscale-antiring=0.0
    dither-depth=no
    correct-downscaling=no
    sigmoid-upscaling=no
    deband=no
    hwdec=auto

    [60FPS]
    profile-desc=cond:is_laptop() and get('container-fps', 0) >= 59
    scale=bilinear
    cscale=bilinear

    [4K]
    profile-desc=cond:get('width', -math.huge) >= 3840
    vd-lavc-threads=32

    [4K-inverted]
    profile-desc=cond:get('width', -math.huge) < 3840
    vd-lavc-threads=0


    [default]


    ###################################
    # Protocol Specific Configuration #
    ###################################

    [protocol.https]
    #cache=yes
    #cache-default=500000                    # size in KB
    #cache-backbuffer=250000                 # size in KB
    cache-secs=100                          # how many seconds of audio/video to prefetch
    user-agent='Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0'

    [protocol.http]
    #cache=yes
    #cache-default=500000                    # size in KB
    #cache-backbuffer=250000                 # size in KB
    cache-secs=100                          # how many seconds of audio/video to prefetch
    user-agent='Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0'

    [extension.gif]
    cache=no
    no-pause
    loop-file=yes

    [extension.webm]
    #cache=no
    #no-pause
    #loop-file=yes
  #+end_src
- input.conf
  #+begin_src conf :tangle (expand-tangle-target ".config/mpv/input.conf")
    # mpv keybindings
    #
    # Location of user-defined bindings: ~/.config/mpv/input.conf
    #
    # Lines starting with # are comments. Use SHARP to assign the # key.
    # Copy this file and uncomment and edit the bindings you want to change.
    #
    # List of commands and further details: DOCS/man/input.rst
    # List of special keys: --input-keylist
    # Keybindings testing mode: mpv --input-test --force-window --idle
    #
    # Use 'ignore' to unbind a key fully (e.g. 'ctrl+a ignore').
    #
    # Strings need to be quoted and escaped:
    #   KEY show-text "This is a single backslash: \\ and a quote: \" !"
    #
    # You can use modifier-key combinations like Shift+Left or Ctrl+Alt+x with
    # the modifiers Shift, Ctrl, Alt and Meta (may not work on the terminal).
    #
    # The default keybindings are hardcoded into the mpv binary.
    # You can disable them completely with: --no-input-default-bindings

    # Developer note:
    # On compilation, this file is baked into the mpv binary, and all lines are
    # uncommented (unless '#' is followed by a space) - thus this file defines the
    # default key bindings.

    # If this is enabled, treat all the following bindings as default.
    #default-bindings start

    #MOUSE_BTN0 ignore                      # don't do anything
    #MOUSE_BTN0_DBL cycle fullscreen        # toggle fullscreen on/off
    #MOUSE_BTN2 cycle pause                 # toggle pause on/off
    #MOUSE_BTN3 seek 10
    #MOUSE_BTN4 seek -10
    #MOUSE_BTN5 add volume -2
    #MOUSE_BTN6 add volume 2

    # Mouse wheels, touchpad or other input devices that have axes
    # if the input devices supports precise scrolling it will also scale the
    # numeric value accordingly
    #AXIS_UP    seek 10
    #AXIS_DOWN  seek -10
    #AXIS_LEFT  seek 5
    #AXIS_RIGHT seek -5

    ## Seek units are in seconds, but note that these are limited by keyframes
    #RIGHT seek  5
    #LEFT  seek -5
    #UP    seek  60
    #DOWN  seek -60
    RIGHT  seek  5
    LEFT   seek -5
    UP     seek -60
    DOWN   seek  60
    Ctrl+f seek  5
    Ctrl+b seek -5
    Ctrl+p seek -60
    Ctrl+n seek  60
    # Do smaller, always exact (non-keyframe-limited), seeks with shift.
    # Don't show them on the OSD (no-osd).
    #Shift+RIGHT no-osd seek  1 exact
    #Shift+LEFT  no-osd seek -1 exact
    #Shift+UP    no-osd seek  5 exact
    #Shift+DOWN  no-osd seek -5 exact
    # Skip to previous/next subtitle (subject to some restrictions; see manpage)
    #Ctrl+LEFT   no-osd sub-seek -1
    #Ctrl+RIGHT  no-osd sub-seek  1
    #PGUP add chapter 1                     # skip to next chapter
    #PGDWN add chapter -1                   # skip to previous chapter
    PGUP add chapter -1                     # skip to next chapter
    PGDWN add chapter 1                     # skip to previous chapter
    #Shift+PGUP seek 600
    #Shift+PGDWN seek -600
    #[ multiply speed 0.9091                # scale playback speed
    #] multiply speed 1.1
    #{ multiply speed 0.5
    #} multiply speed 2.0
    #BS set speed 1.0                       # reset speed to normal
    #q quit
    #Q quit-watch-later
    #q {encode} quit 4
    #ESC set fullscreen no
    #ESC {encode} quit 4
    #p cycle pause                          # toggle pause/playback mode
    #. frame-step                           # advance one frame and pause
    #, frame-back-step                      # go back by one frame and pause
    #SPACE cycle pause
    ? playlist-shuffle                      # skip to random file
    #> playlist-next                        # skip to next file
    #ENTER playlist-next                    # skip to next file
    #< playlist-prev                        # skip to previous file
    #O no-osd cycle-values osd-level 3 1    # cycle through OSD mode
    #o show-progress
    #P show-progress
    #I show-text "${filename}"              # display filename in osd
    #z add sub-delay -0.1                   # subtract 100 ms delay from subs
    #x add sub-delay +0.1                   # add
    #ctrl++ add audio-delay 0.100           # this changes audio/video sync
    #ctrl+- add audio-delay -0.100
    #9 add volume -2
    #/ add volume -2
    #0 add volume 2
    #* add volume 2
    #m cycle mute
    #1 add contrast -1
    #2 add contrast 1
    #3 add brightness -1
    #4 add brightness 1
    #5 add gamma -1
    #6 add gamma 1
    #7 add saturation -1
    #8 add saturation 1
    #Alt+0 set window-scale 0.5
    #Alt+1 set window-scale 1.0
    #Alt+2 set window-scale 2.0
    # toggle deinterlacer (automatically inserts or removes required filter)
    #d cycle deinterlace
    #r add sub-pos -1                       # move subtitles up
    #t add sub-pos +1                       #                down
    #v cycle sub-visibility
    # stretch SSA/ASS subtitles with anamorphic videos to match historical
    #V cycle sub-ass-vsfilter-aspect-compat
    # switch between applying no style overrides to SSA/ASS subtitles, and
    # overriding them almost completely with the normal subtitle style
    #u cycle-values sub-ass-style-override "force" "no"
    #j cycle sub                            # cycle through subtitles
    #J cycle sub down                       # ...backwards
    #SHARP cycle audio                      # switch audio streams
    #_ cycle video
    #T cycle ontop                          # toggle video window ontop of other windows
    #f cycle fullscreen                     # toggle fullscreen
    #s async screenshot                     # take a screenshot
    #S async screenshot video               # ...without subtitles
    #Ctrl+s async screenshot window         # ...with subtitles and OSD, and scaled
    #Alt+s screenshot each-frame            # automatically screenshot every frame
    #w add panscan -0.1                     # zoom out with -panscan 0 -fs
    #e add panscan +0.1                     #      in
    # cycle video aspect ratios; "-1" is the container aspect
    #A cycle-values video-aspect "16:9" "4:3" "2.35:1" "-1"
    #POWER quit
    #PLAY cycle pause
    #PAUSE cycle pause
    #PLAYPAUSE cycle pause
    #STOP quit
    #FORWARD seek 60
    #REWIND seek -60
    #NEXT playlist-next
    #PREV playlist-prev
    #VOLUME_UP add volume 2
    #VOLUME_DOWN add volume -2
    #MUTE cycle mute
    #CLOSE_WIN quit
    #CLOSE_WIN {encode} quit 4
    #E cycle edition                        # next edition
    #l ab-loop                              # Set/clear A-B loop points
    #L cycle-values loop-file "inf" "no"    # toggle infinite looping
    #ctrl+c quit 4

    # Apple Remote section
    #AR_PLAY cycle pause
    #AR_PLAY_HOLD quit
    #AR_CENTER cycle pause
    #AR_CENTER_HOLD quit
    #AR_NEXT seek 10
    #AR_NEXT_HOLD seek 120
    #AR_PREV seek -10
    #AR_PREV_HOLD seek -120
    #AR_MENU show-progress
    #AR_MENU_HOLD cycle mute
    #AR_VUP add volume 2
    #AR_VUP_HOLD add chapter 1
    #AR_VDOWN add volume -2
    #AR_VDOWN_HOLD add chapter -1

    # For tv://
    #h cycle tv-channel -1                  # previous channel
    #k cycle tv-channel +1                  # next channel

    # For dvb://
    #H cycle dvb-channel-name -1            # previous channel
    #K cycle dvb-channel-name +1            # next channel

    #
    # Legacy bindings (may or may not be removed in the future)
    #
    #! add chapter -1                       # skip to previous chapter
    #@ add chapter 1                        #         next

    #
    # Not assigned by default
    # (not an exhaustive list of unbound commands)
    #

    # ? add sub-scale +0.1                  # increase subtitle font size
    # ? add sub-scale -0.1                  # decrease subtitle font size
    # ? sub-step -1                         # immediately display next subtitle
    # ? sub-step +1                         #                     previous
    # ? cycle angle                         # switch DVD/Bluray angle
    # ? add balance -0.1                    # adjust audio balance in favor of left
    Z add balance -0.1                    # adjust audio balance in favor of left
    # ? add balance 0.1                     #                                  right
    X add balance 0.1                     #                                  right
    # ? cycle sub-forced-only               # toggle DVD forced subs
    # ? cycle program                       # cycle transport stream programs
    # ? stop                                # stop playback (quit or enter idle mode)
  #+end_src
- scripts
  #+begin_src lua :tangle (expand-tangle-target ".config/mpv/scripts/delete_file.lua")
    local utils = require "mp.utils"

    del_list = {}

    function contains_item(l, i)
       for k, v in pairs(l) do
          if v == i then
             mp.osd_message("undeleting current file")
             l[k] = nil
             return true
          end
       end
       mp.osd_message("deleting current file")
       return false
    end

    function mark_delete()
       local work_dir = mp.get_property_native("working-directory")
       local file_path = mp.get_property_native("path")
       local s = file_path:find(work_dir, 0, true)
       local final_path
       if s and s == 0 then
          final_path = file_path
       else
          final_path = utils.join_path(work_dir, file_path)
       end
       if not contains_item(del_list, final_path) then
          table.insert(del_list, final_path)
       end
    end

    function delete(e)
       if e.reason == "quit" then
          for i, v in pairs(del_list) do
             print("deleting: "..v)
             os.remove(v)
          end
       end
    end

    mp.add_key_binding("ctrl+DEL", "delete_file", mark_delete)
    mp.register_event("end-file", delete)
  #+end_src

* unison
- music directory syncing
  #+begin_src conf :noweb tangle :tangle (expand-tangle-target ".unison/music.prf")
    # Roots of the synchronization
    root = <<home-dir()>>/mnt/ruizu/Music
    root = <<home-dir()>>/Audio

    # Paths to synchronize
    path = .

    # Ruizu's file system is FAT
    fat = true

    # Overwrite by newer file on confliction
    prefer = newer

    # Show nothing
    silent = true
    confirmbigdel = false

    # Do fast checking
    fastcheck = true

    # Log settings
    log = true
    logfile = <<home-dir()>>/var/log/unison/music.log

  #+end_src
- doc directory backup
  #+begin_src conf :noweb tangle :tangle (expand-tangle-target ".unison/doc.prf")
    # Roots of the synchronization
    root = <<home-dir()>>/mnt/ns01
    root = /media/<<whoami()>>/uhd01

    # Paths to synchronize
    path = doc

    # Overwrite by newer file on confliction
    prefer = newer

    # Use this command for displaying diffs
    diff = diff -y -W 79 --suppress-common-lines

    # Write down synchronization activity on log file rather than show in stdout
    auto = true
    confirmbigdel = false
    silent = true
    log = true
    logfile = <<home-dir()>>/var/log/unison/doc.log

    # Use inode number to verify identity rather than ckeck whole byte sequence
    fastcheck = true

    # Abort if device is not mounted
    mountpoint = doc
  #+end_src
* crontab
- crontab script for my private PC
  #+begin_src conf :noweb tangle :tangle (expand-tangle-target ".config/crontab/pc01")
    MAILTO="<<email()>>"

    BIN_DIR="<<home-dir()>>/bin"
    LOCAL_BIN_DIR="<<home-dir()>>/.local/bin"
    LOG_DIR="<<home-dir()>>/var/log"

    PATH=<<home-dir()>>/usr/bin:<<home-dir()>>/.local/bin:<<home-dir()>>/.anyenv/envs/pyenv/shims:/bin:/usr/bin:/usr/sbin
    HOME=<<home-dir()>>

    30 0 * * 2,5 /bin/bash <<home-dir()>>/.local/bin/snapshot.sh >> $LOG_DIR/snapshot.log 2>&1
    0 2 * * * $LOCAL_BIN_DIR/tidyup >> $LOG_DIR/tidyup.log 2>&1
    0 3,15 * * * /bin/bash $BIN_DIR/gitsync-local <<home-dir()>>/git/ >> $LOG_DIR/gitsync-local.log 2>&1
    5 3,15 * * * /bin/bash $BIN_DIR/gitsync-remote <<home-dir()>>/git/ >> $LOG_DIR/gitsync-remote.log 2>&1
  #+end_src
